{% extends "base.html" %}
{% load dict_access %}

  {% block crumbs %}
    <ul class="breadcrumb">
      <li><a href="/"><span class="glyphicon glyphicon-home"></span></a></li>
      <li><a href="{% url "shows" %}">Shows</a></li>
      <li><a href="{% url "edit-show" episode.show.id %}">{{episode.show}}</a></li>
      <li class="active">{{episode.air_date}}</li>
    </ul>
    {% endblock %}
 
    {% block content %}
    <h2>{{episode}}</h2>

    <ul class='nav nav-tabs'>
      {% for seg_name in ordered_names %}
      <li{% if seg_name == seg_type %} class='active'{% endif %}>
        <a href='#{{ seg_name }}' data-toggle='tab'>
          {{ seg_name }}
        </a>
      </li>
      {% endfor %}
    </ul>

    <div id='segforms' class='tab-content'>
      {% for seg_name in ordered_names %}
      <div class='tab-pane{% if seg_name == seg_type %} active{% endif %}' id='{{ seg_name }}'>
        <form method="POST" action="">
          {% csrf_token %}
          <input type='hidden' name='seg_type' value='{{ seg_name }}'>
          <ul class="list-inline">
            <input class="btn btn-primary" type="submit">
            {{ form.as_ul }}
            <li>
            <ul class='nav nav-pills' id='X{{ seg_name }}'>
              <li id='{{ seg_name }}Status'>Using existing
              <li class="active"> 
              <a href="#Auto{{ seg_name }}" data-toggle='tab' style='display:none'
                onClick='$("#X{{ seg_name }} a:first").hide();$("#X{{ seg_name }} a:last").show();
                $("#{{ seg_name }}Status").text("Using Existing {{ seg_name }}")'>
                Use Existing</a>
              <li> <a href="#New{{ seg_name }}" data-toggle='tab' onClick='$("#X{{ seg_name }} a:last").hide();$("#X{{ seg_name }} a:first").show();
                $("#{{ seg_name }}Status").text("Creating New {{ seg_name }}")'>Create New</a>
            </ul>
          </ul>
          <div class='tab-content'>
            <div class='tab-pane active' id='Auto{{seg_name}}'> <!-- TODO activate if autoform -->
              <ul class="list-inline">
                {% with 'Auto'|add:seg_name as auto_seg_name %}
                {% with forms|access:auto_seg_name as auto_form %}
                {{ auto_form.as_ul }}
                {% endwith %}
                {% endwith %}
              </ul>
            </div>
            <div class='tab-pane' id='New{{ seg_name }}'>
              <ul class="list-inline">
                {% with forms|access:seg_name as seg_form %}
                {{ seg_form.as_ul }}
                {% endwith %}
              </ul>
            </div>
          </div>
        </form>
      </div>
      {% endfor %}
    </div>
    <ul>
      {% for segment in segment_list reversed %}
      <li> {{ segment }} </li>
      {% endfor %}
    </ul>
    {% endblock %}
